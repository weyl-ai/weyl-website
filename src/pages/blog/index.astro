---
// src/pages/blog/index.astro
import { getCollection } from 'astro:content';
import type { CollectionEntry } from 'astro:content';
import BaseHead from '@/layouts/BaseHead.astro';
import LandingNav from '@components/landing/LandingNav.astro';
import LandingFooter from '@components/landing/LandingFooter.astro';
import Card from '@components/ui/Card.astro';

// Import global styles
import '@/styles/tokens.css';
import '@/styles/global.css';
import '@/styles/typography.css';

const blogPosts = (await getCollection('blog'))
  .filter((post: CollectionEntry<'blog'>) => !post.data.draft)
  .sort((a: CollectionEntry<'blog'>, b: CollectionEntry<'blog'>) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());
---

<!DOCTYPE html>
<html lang="en">
  <head>
    <BaseHead 
      title="Blog" 
      description="Updates, insights, and announcements from the Weyl team"
    />
  </head>
  <body class="bg-bg-primary min-h-screen">
    <LandingNav />
    <main class="max-w-4xl mx-auto px-6 py-24 pt-32">
      <header class="mb-16">
        <h1 class="font-display text-hero font-semibold tracking-widest text-brand-primary mb-4">
          // BLOG
        </h1>
        <p class="font-mono text-body text-text-secondary">
          Updates, insights, and announcements from the Weyl team
        </p>
      </header>

      <div class="space-y-8">
        {blogPosts.map((post: CollectionEntry<'blog'>) => (
          <Card 
            href={`/blog/${post.slug}`}
            variant="interactive"
          >
            <div class="flex flex-col gap-3">
              <h2 class="font-mono text-subhead font-semibold text-text-primary">
                {post.data.title}
              </h2>
              <p class="font-mono text-body text-text-secondary">
                {post.data.description}
              </p>
              <div class="flex gap-4 text-caption text-text-muted">
                <time datetime={post.data.pubDate.toISOString()}>
                  {post.data.pubDate.toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                  })}
                </time>
                <span>â€¢</span>
                <span>{post.data.author}</span>
              </div>
              {post.data.tags.length > 0 && (
                <div class="flex gap-2 flex-wrap">
                  {post.data.tags.map((tag: string) => (
                    <span class="px-2 py-1 bg-bg-elevated text-text-muted text-caption rounded-sm">
                      {tag}
                    </span>
                  ))}
                </div>
              )}
            </div>
          </Card>
        ))}
      </div>
    </main>
    <LandingFooter />
  </body>
</html>
